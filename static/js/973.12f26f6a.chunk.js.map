{"version":3,"file":"static/js/973.12f26f6a.chunk.js","mappings":"iPAYA,MAuEA,EAvEqCA,KACnC,MAAMC,GAAWC,EAAAA,EAAAA,OAEVC,EAAOC,KADGC,EAAAA,EAAAA,OACSC,EAAAA,EAAAA,UAAwB,QAE3CC,IAAgBC,EAAAA,EAAAA,OAEvBC,EAAAA,EAAAA,YAAU,KAER,MAAMC,EAAWH,EAAaI,IAAI,SAE9BD,EACFN,EAASM,GAETE,EAAAA,GAAQC,MAAM,+DAChB,GACC,CAACN,IAwBJ,OACEO,EAAAA,EAAAA,MAACC,EAAAA,EAAa,CACZC,MAAO,CAAEC,OAAQ,SACjBC,MAAM,2BACNC,SAAS,mDACTC,SA3BaC,UACf,GAAIC,EAAOC,cAAgBD,EAAOE,gBAIlC,GAAKrB,EAIL,IACE,MAAMsB,QAAiBC,EAAAA,EAAMC,KAAK,+BAAgC,CAChExB,QACAoB,YAAaD,EAAOC,cAEtBX,EAAAA,GAAQgB,QAAQH,EAASI,KAAKjB,SAC9BX,EAAS,SACX,CAAE,MAAOY,GAAQ,IAADiB,EAAAC,EACd,MAAMC,EAAMnB,EACZD,EAAAA,GAAQC,OAAmB,QAAbiB,EAACE,EAAIP,gBAAQ,IAAAK,GAAM,QAANC,EAAZD,EAAcD,YAAI,IAAAE,OAAN,EAAbA,EAA2ClB,QAAS,6CACpE,MAbED,EAAAA,GAAQC,MAAM,mDAJdD,EAAAA,GAAQC,MAAM,qEAiBhB,EAQqBoB,SAAA,EAEnBC,EAAAA,EAAAA,KAACC,EAAAA,EAAYC,SAAQ,CACnBC,KAAK,cACLC,WAAY,CACVC,KAAM,QACNC,QAAQN,EAAAA,EAAAA,KAACO,EAAAA,EAAY,KAEvBC,YAAY,qBACZC,MAAO,CAAC,CAAEC,UAAU,EAAMhC,QAAS,+CACnCiC,YAAU,KAEZX,EAAAA,EAAAA,KAACC,EAAAA,EAAYC,SAAQ,CACnBC,KAAK,kBACLC,WAAY,CACVC,KAAM,QACNC,QAAQN,EAAAA,EAAAA,KAACO,EAAAA,EAAY,KAEvBC,YAAY,iCACZC,MAAO,CAAC,CAAEC,UAAU,EAAMhC,QAAS,2DACnCiC,YAAU,MAEE,C,6DC7EpB,QADmB,CAAE,KAAQ,CAAE,IAAO,MAAO,MAAS,CAAE,QAAW,gBAAiB,UAAa,SAAW,SAAY,CAAC,CAAE,IAAO,OAAQ,MAAS,CAAE,EAAK,2VAA+V,KAAQ,OAAQ,MAAS,Y,eCM9gBJ,EAAe,SAAsBK,EAAOC,GAC9C,OAAoBC,EAAAA,cAAoBC,EAAAA,GAAUC,EAAAA,EAAAA,GAAS,CAAC,EAAGJ,EAAO,CACpEC,IAAKA,EACLI,KAAMC,IAEV,EAOA,QAJ2BJ,EAAAA,WAAiBP,E","sources":["ActionPassword.tsx","../node_modules/@ant-design/icons-svg/es/asn/LockOutlined.js","../node_modules/@ant-design/icons/es/icons/LockOutlined.js"],"sourcesContent":["// frontend/src/ActionPasswordPage.tsx\r\nimport { useEffect, useState } from \"react\";\r\nimport { useNavigate, useLocation, useSearchParams } from \"react-router-dom\"; // 新增 useSearchParams\r\nimport { message } from \"antd\";\r\nimport {\r\n  LoginFormPage,\r\n  ProFormText,\r\n} from \"@ant-design/pro-components\";\r\nimport { LockOutlined } from \"@ant-design/icons\";\r\nimport axios, { AxiosError } from \"axios\";\r\nimport md5 from \"md5\";\r\n\r\nconst ActionPasswordPage: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const [token, setToken] = useState<string | null>(null);\r\n\r\n  const [searchParams] = useSearchParams();\r\n\r\n  useEffect(() => {\r\n    // 直接从 searchParams 中获取 token\r\n    const urlToken = searchParams.get(\"token\");\r\n\r\n    if (urlToken) {\r\n      setToken(urlToken);\r\n    } else {\r\n      message.error(\"无效的密码重置链接！\");\r\n    }\r\n  }, [searchParams]);\r\n\r\n  const onFinish = async (values: any) => {\r\n    if (values.newPassword !== values.confirmPassword) {\r\n      message.error(\"两次输入的密码不一致！\");\r\n      return;\r\n    }\r\n    if (!token) {\r\n      message.error(\"缺少重置令牌！\");\r\n      return;\r\n    }\r\n    try {\r\n      const response = await axios.post(\"/user/change-password/action\", {\r\n        token,\r\n        newPassword: values.newPassword,\r\n      });\r\n      message.success(response.data.message);\r\n      navigate(\"/login\");\r\n    } catch (error) {\r\n      const err = error as AxiosError;\r\n      message.error((err.response?.data as { error: string })?.error || \"密码重置失败！\");\r\n    }\r\n  };\r\n\r\n  return (\r\n    <LoginFormPage\r\n      style={{ height: \"100vh\" }}\r\n      title=\"重置密码\"\r\n      subTitle=\"请输入您的新密码\"\r\n      onFinish={onFinish}\r\n    >\r\n      <ProFormText.Password\r\n        name=\"newPassword\"\r\n        fieldProps={{\r\n          size: \"large\",\r\n          prefix: <LockOutlined />,\r\n        }}\r\n        placeholder=\"新密码\"\r\n        rules={[{ required: true, message: \"请输入新密码！\" }]}\r\n        allowClear\r\n      />\r\n      <ProFormText.Password\r\n        name=\"confirmPassword\"\r\n        fieldProps={{\r\n          size: \"large\",\r\n          prefix: <LockOutlined />,\r\n        }}\r\n        placeholder=\"确认新密码\"\r\n        rules={[{ required: true, message: \"请再次输入新密码！\" }]}\r\n        allowClear\r\n      />\r\n    </LoginFormPage>\r\n  );\r\n};\r\n\r\nexport default ActionPasswordPage;\r\n","// This icon file is generated automatically.\nvar LockOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z\" } }] }, \"name\": \"lock\", \"theme\": \"outlined\" };\nexport default LockOutlined;\n","import _extends from \"@babel/runtime/helpers/esm/extends\";\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\n\nimport * as React from 'react';\nimport LockOutlinedSvg from \"@ant-design/icons-svg/es/asn/LockOutlined\";\nimport AntdIcon from \"../components/AntdIcon\";\nvar LockOutlined = function LockOutlined(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, _extends({}, props, {\n    ref: ref,\n    icon: LockOutlinedSvg\n  }));\n};\n\n/**![lock](data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIGZpbGw9IiNjYWNhY2EiIHZpZXdCb3g9IjY0IDY0IDg5NiA4OTYiIGZvY3VzYWJsZT0iZmFsc2UiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTgzMiA0NjRoLTY4VjI0MGMwLTcwLjctNTcuMy0xMjgtMTI4LTEyOEgzODhjLTcwLjcgMC0xMjggNTcuMy0xMjggMTI4djIyNGgtNjhjLTE3LjcgMC0zMiAxNC4zLTMyIDMydjM4NGMwIDE3LjcgMTQuMyAzMiAzMiAzMmg2NDBjMTcuNyAwIDMyLTE0LjMgMzItMzJWNDk2YzAtMTcuNy0xNC4zLTMyLTMyLTMyek0zMzIgMjQwYzAtMzAuOSAyNS4xLTU2IDU2LTU2aDI0OGMzMC45IDAgNTYgMjUuMSA1NiA1NnYyMjRIMzMyVjI0MHptNDYwIDYwMEgyMzJWNTM2aDU2MHYzMDR6TTQ4NCA3MDF2NTNjMCA0LjQgMy42IDggOCA4aDQwYzQuNCAwIDgtMy42IDgtOHYtNTNhNDguMDEgNDguMDEgMCAxMC01NiAweiIgLz48L3N2Zz4=) */\nvar RefIcon = /*#__PURE__*/React.forwardRef(LockOutlined);\nif (process.env.NODE_ENV !== 'production') {\n  RefIcon.displayName = 'LockOutlined';\n}\nexport default RefIcon;"],"names":["ActionPasswordPage","navigate","useNavigate","token","setToken","useLocation","useState","searchParams","useSearchParams","useEffect","urlToken","get","message","error","_jsxs","LoginFormPage","style","height","title","subTitle","onFinish","async","values","newPassword","confirmPassword","response","axios","post","success","data","_err$response","_err$response$data","err","children","_jsx","ProFormText","Password","name","fieldProps","size","prefix","LockOutlined","placeholder","rules","required","allowClear","props","ref","React","AntdIcon","_extends","icon","LockOutlinedSvg"],"sourceRoot":""}