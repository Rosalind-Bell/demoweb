"use strict";(self.webpackChunkweb_workshop=self.webpackChunkweb_workshop||[]).push([[417],{44417:(e,t,s)=>{s.r(t),s.d(t,{default:()=>w});var i=s(65043),n=s(16199),l=s(22019),o=s(87021),r=s(91686),a=s(48807),c=s(90617),d=s(80132),p=s(89330),h=s(86213),u=s(68088),x=s(70579);const{Dragger:y}=n.A,m=async e=>{try{return(await h.A.get("/file/list?room="+e)).data.fileList}catch(t){return console.error(t),l.Ay.error("\u83b7\u53d6\u6587\u4ef6\u5217\u8868\u5931\u8d25\uff01"),[]}},j=e=>{let{roomUUID:t,filelist:s}=e;const i=e=>(0,x.jsx)(o.Ay,{type:"link",style:{fontSize:"18px",width:"18px",height:"18px",padding:0},onClick:async()=>await(async(e,t)=>{try{l.Ay.info("\u6b63\u5728\u8bf7\u6c42\u4e0b\u8f7d...");const s=await h.A.get("/file/download?room="+e+"&filename="+t),i=window.URL.createObjectURL(new Blob([s.data])),n=document.createElement("a");n.href=i,n.setAttribute("download",t),document.body.appendChild(n),n.click(),n.remove(),l.Ay.success("\u5f00\u59cb\u4e0b\u8f7d\u6587\u4ef6\uff01")}catch(s){console.error(s),l.Ay.error("\u4e0b\u8f7d\u6587\u4ef6\u5931\u8d25\uff01")}})(t,e),children:(0,x.jsx)(p.A,{})});return(0,x.jsx)(u.OY,{children:(0,x.jsx)(a.A,{size:"small",dataSource:s,renderItem:e=>(0,x.jsx)(a.A.Item,{style:{padding:"8px"},actions:[i(e)],children:(0,x.jsx)(u.EY,{style:{wordBreak:"break-all"},children:e})})})})},w=e=>{let{room:t,handleClose:s}=e;const[n,a]=(0,i.useState)([]),[p,w]=(0,i.useState)(!1),[f,A]=(0,i.useState)(!1);(0,i.useEffect)((()=>{t&&m(t.uuid).then(a)}),[t]);const g=()=>{A(!0),t&&m(t.uuid).then(a),setTimeout((()=>A(!1)),1e3)},k=()=>(0,x.jsx)(o.Ay,{type:"link",style:{width:"40px",height:"40px",fontSize:"16px",position:"absolute",left:0,top:0},className:"need-interaction",onClick:g,children:(0,x.jsx)(c.A,{spin:f})}),b=()=>(0,x.jsx)(o.Ay,{type:"link",style:{width:"40px",height:"40px",fontSize:"12px",position:"absolute",right:0,top:0},className:"need-interaction",onClick:s,children:"\u274c"});return t?(0,x.jsxs)(u.Zp,{style:{width:"300px",height:"500px"},children:[(0,x.jsx)(k,{}),(0,x.jsx)(b,{}),(0,x.jsxs)(u.mc,{style:{margin:"6px"},children:[(0,x.jsx)(u.EY,{children:(0,x.jsx)("strong",{children:t.name})}),(0,x.jsx)(u.EY,{size:"small",style:{marginTop:"6px",marginBottom:"6px"},children:"\u6587\u4ef6\u5171\u4eab\u7a7a\u95f4"})]}),(0,x.jsx)(j,{roomUUID:t.uuid,filelist:n}),(0,x.jsx)("div",{className:"need-interaction",style:{marginTop:"12px",width:"100%"},children:(0,x.jsxs)(y,{customRequest:e=>{let{file:s,onSuccess:i,onError:n}=e;(async(e,s,i)=>{w(!0);const n=new FormData;n.append("file",e);try{await h.A.post("/file/upload/"+(null===t||void 0===t?void 0:t.uuid),n),await m(null===t||void 0===t?void 0:t.uuid).then(a),l.Ay.success("\u4e0a\u4f20\u6587\u4ef6\u6210\u529f\uff01"),null===s||void 0===s||s()}catch(o){console.error(o),l.Ay.error("\u4e0a\u4f20\u6587\u4ef6\u5931\u8d25\uff01"),null===i||void 0===i||i(o)}finally{w(!1)}})(s,i,n)},showUploadList:!1,disabled:p,children:[(0,x.jsx)("p",{className:"ant-upload-drag-icon",children:p?(0,x.jsx)(r.A,{size:"large"}):(0,x.jsx)(d.A,{})}),(0,x.jsx)("p",{className:"ant-upload-text",children:"\u62d6\u62fd\u6216\u70b9\u51fb\u4e0a\u4f20\u6587\u4ef6"})]})})]}):null}}}]);
//# sourceMappingURL=417.16944473.chunk.js.map